<div class="space-y-6">
  <!-- Header -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Mes Tâches</h1>
      <p class="text-gray-500 mt-1">Toutes les tâches qui vous sont assignées</p>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
    <button (click)="setFilter(null)"
            [class.ring-2]="statusFilter() === null"
            class="bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-all text-left ring-blue-500">
      <div class="text-2xl font-bold text-gray-900">{{ tasks().length }}</div>
      <div class="text-sm text-gray-500">Total</div>
    </button>
    <button (click)="setFilter('TODO')"
            [class.ring-2]="statusFilter() === 'TODO'"
            class="bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-all text-left ring-gray-500">
      <div class="text-2xl font-bold text-gray-600">{{ todoCount() }}</div>
      <div class="text-sm text-gray-500">À faire</div>
    </button>
    <button (click)="setFilter('IN_PROGRESS')"
            [class.ring-2]="statusFilter() === 'IN_PROGRESS'"
            class="bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-all text-left ring-yellow-500">
      <div class="text-2xl font-bold text-yellow-600">{{ inProgressCount() }}</div>
      <div class="text-sm text-gray-500">En cours</div>
    </button>
  </div>

  <!-- Error -->
  @if (error()) {
    <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl">
      {{ error() }}
    </div>
  }

  <!-- Loading -->
  @if (isLoading()) {
    <div class="flex items-center justify-center py-12">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <span class="ml-3 text-gray-600">Chargement...</span>
    </div>
  } @else {
    <!-- Empty State -->
    @if (filteredTasks().length === 0) {
      <div class="bg-white rounded-2xl p-12 text-center border border-gray-100 shadow-sm">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 6h13"/><path d="M8 12h13"/><path d="M8 18h13"/><circle cx="4" cy="6" r="1"/><circle cx="4" cy="12" r="1"/><circle cx="4" cy="18" r="1"/></svg>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Aucune tâche</h3>
        <p class="text-gray-500">Aucune tâche ne vous est assignée pour le moment.</p>
      </div>
    } @else {
      <!-- Tasks List -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-100 divide-y divide-gray-100">
        @for (task of filteredTasks(); track task.id) {
          <div (click)="goToProject(task.projectId)"
               class="p-4 hover:bg-gray-50 transition-colors cursor-pointer flex items-center gap-4">
            <!-- Status Dot -->
            <div [class]="'w-3 h-3 rounded-full flex-shrink-0 ' +
              (task.status === 'TODO' ? 'bg-gray-400' :
               task.status === 'IN_PROGRESS' ? 'bg-yellow-400' :
               'bg-green-400')">
            </div>

            <!-- Task Info -->
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2 mb-1">
                <h4 class="font-medium text-gray-900 truncate">{{ task.name }}</h4>
                <span [class]="'px-2 py-0.5 rounded text-xs font-medium flex-shrink-0 ' + getPriorityClass(task.priority)">
                  {{ task.priority }}
                </span>
              </div>
              <div class="flex items-center gap-3 text-sm text-gray-500">
                <span class="flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/></svg>
                  {{ task.projectName }}
                </span>
                <span class="flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
                  {{ task.dueDate | date:'dd MMM yyyy' }}
                </span>
              </div>
            </div>

            <!-- Status Badge -->
            <span [class]="'px-3 py-1 rounded-full text-xs font-medium flex-shrink-0 ' + getStatusClass(task.status)">
              {{ getStatusLabel(task.status) }}
            </span>

            <!-- Arrow -->
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg>
          </div>
        }
      </div>
    }
  }
</div>
