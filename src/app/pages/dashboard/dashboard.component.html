<div class="space-y-8">
  <!-- Welcome Section -->
  <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-8 text-white shadow-xl">
    <h1 class="text-2xl font-bold mb-2">
      Bonjour, {{ currentUser()?.username }} ! üëã
    </h1>
    <p class="text-blue-100">Voici un aper√ßu de vos projets et t√¢ches.</p>
  </div>

  <!-- Error Message -->
  @if (error()) {
    <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl">
      {{ error() }}
    </div>
  }

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="flex items-center justify-center py-12">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <span class="ml-3 text-gray-600">Chargement...</span>
    </div>
  } @else {
    <!-- Stats Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
      @for (stat of stats(); track stat.label) {
        <div (click)="navigateTo(stat.route)"
             class="bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all cursor-pointer">
          <div class="flex items-center justify-between mb-4">
            <div [class]="'w-12 h-12 rounded-xl flex items-center justify-center ' +
              (stat.color === 'blue' ? 'bg-blue-100 text-blue-600' :
               stat.color === 'yellow' ? 'bg-yellow-100 text-yellow-600' :
               stat.color === 'green' ? 'bg-green-100 text-green-600' :
               'bg-purple-100 text-purple-600')">
              @switch (stat.icon) {
                @case ('folder') {
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/></svg>
                }
                @case ('tasks') {
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                }
                @case ('check') {
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                }
                @case ('todo') {
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 6h13"/><path d="M8 12h13"/><path d="M8 18h13"/><circle cx="4" cy="6" r="1"/><circle cx="4" cy="12" r="1"/><circle cx="4" cy="18" r="1"/></svg>
                }
              }
            </div>
          </div>
          <div class="text-3xl font-bold text-gray-900 mb-1">{{ stat.value }}</div>
          <div class="text-sm text-gray-500">{{ stat.label }}</div>
        </div>
      }
    </div>

    <!-- Recent Tasks -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-100">
      <div class="p-6 border-b border-gray-100 flex items-center justify-between">
        <h2 class="text-lg font-semibold text-gray-900">T√¢ches r√©centes</h2>
        <a routerLink="/app/tasks" class="text-sm text-blue-600 hover:text-blue-700 font-medium">
          Voir tout ‚Üí
        </a>
      </div>

      @if (recentTasks().length === 0) {
        <div class="p-8 text-center text-gray-500">
          <p>Aucune t√¢che ne vous est assign√©e pour le moment.</p>
          <p class="text-sm mt-1">Les t√¢ches appara√Ætront ici une fois qu'elles vous seront assign√©es.</p>
        </div>
      } @else {
        <div class="divide-y divide-gray-100">
          @for (task of recentTasks(); track task.id) {
            <div (click)="goToProject(task.projectId)"
                 class="p-4 hover:bg-gray-50 transition-colors cursor-pointer flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div [class]="'w-2 h-2 rounded-full ' +
                  (task.status === 'TODO' ? 'bg-gray-400' :
                   task.status === 'IN_PROGRESS' ? 'bg-yellow-400' :
                   'bg-green-400')">
                </div>
                <div>
                  <div class="font-medium text-gray-900">{{ task.name }}</div>
                  <div class="text-sm text-gray-500">{{ task.projectName }}</div>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <span [class]="'px-2.5 py-1 rounded-full text-xs font-medium ' + getPriorityClass(task.priority)">
                  {{ task.priority }}
                </span>
                <span class="text-sm text-gray-500">{{ task.dueDate | date:'dd/MM' }}</span>
              </div>
            </div>
          }
        </div>
      }
    </div>

    <!-- Quick Actions -->
    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
      <h2 class="text-lg font-semibold text-gray-900 mb-4">Actions rapides</h2>
      <div class="flex flex-wrap gap-3">
        <a routerLink="/app/projects"
           class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-all hover:-translate-y-0.5">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/></svg>
          Mes Projets
        </a>
        <a routerLink="/app/tasks"
           class="flex items-center gap-2 bg-white hover:bg-gray-50 text-gray-700 px-4 py-2 rounded-lg font-medium border border-gray-300 transition-all">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 6h13"/><path d="M8 12h13"/><path d="M8 18h13"/><circle cx="4" cy="6" r="1"/><circle cx="4" cy="12" r="1"/><circle cx="4" cy="18" r="1"/></svg>
          Mes T√¢ches
        </a>
      </div>
    </div>
  }
</div>
